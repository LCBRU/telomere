{% extends "standardLayout.html" %}
{% import "_formHelpers.html" as formhelper %}

{% block content %}

<header>
	<h2 class="col-sm-8">Errors for Batch '{{ batch.id }}'</h2>
	<div class="col-sm-4 text-right">
		<form method="POST" action="{{ url_for('batch_errors_complete_all') }}">
		    {{ completeAllForm.hidden_tag() }}
			<button type="submit" class="btn btn-primary">
				<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Complete all outstanding errors for batch
			</button>
		</form>
	</div>
</header>

<div class="clearfix"></div>

<table class="table">
	<thead>
		<tr>
			<th></th>
			<th>Sample Code</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
		{% for item in outstandingErrors.items %}
			<tr>
				<td>
    				<form method="POST" action="{{ url_for('batch_error_complete_post') }}">
		    			{{ completeErrorForm.csrf_token }}
		    			<input id="batchId" name="batchId" type="hidden" value="{{item.batch.id}}" />
		    			<input id="id" name="id" type="hidden" value="{{item.id}}" />
		    			<input id="page" name="page" type="hidden" value="{{outstandingErrors.page}}" />
						<button type="submit" class="btn btn-primary btn-sm">
							<span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Complete
						</button>
					</form>
				</td>
				<td>{{ item.sample.sampleCode }}</td>
				<td>{{ item.description }}</td>
			</tr>
		{% endfor %}
	</tbody>
</table>

{{ formhelper.render_pagination(outstandingErrors, 'batch_errors', id=batch.id) }}

{% endblock %}


{% block script %}

<script type="text/javascript">
    $(function () {
		$( "time" ).each(function() {
			self = $(this);
			m = moment(self.text());
			self.text(m.fromNow());
  		});
    });
</script>

{% endblock %}